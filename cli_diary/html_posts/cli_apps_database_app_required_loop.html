<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
        <meta charset="utf-8" />
        <meta name="generator" content="pandoc" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
        <title>Cli Apps Database App. Required Loop</title>
        <style>
html {
    font-family: Iosevka;
    font-size: 13pt;
    color: #1a1a1a;
    background-color: #fdfdfd;
    line-height: 1.5;
}
    body {
        margin: 0 auto;
        max-width: 45em;
        padding-left: 50px;
        padding-right: 50px;
        padding-top: 50px;
        padding-bottom: 50px;
        hyphens: auto;
        overflow-wrap: break-word;
        text-rendering: optimizeLegibility;
        font-kerning: normal;
    }
    @media (max-width: 600px) {
        body {
            font-size: 0.9em;
            padding: 12px;
        }
        h1 {
            font-size: 1.8em;
        }
    }
    @media print {
        html {
            background-color: white;
        }
        body {
            background-color: transparent;
            color: black;
            font-size: 12pt;
        }
        p, h2, h3 {
            orphans: 3;
            widows: 3;
        }
        h2, h3, h4 {
            page-break-after: avoid;
        }
    }
    p {
        margin: 1em 0;
    }
    a {
        color: #1a1a1a;
    }
    a:visited {
        color: #1a1a1a;
    }
    img {
        max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
        margin-top: 1.4em;
    }
    h5, h6 {
        font-size: 1em;
        font-style: italic;
    }
    h6 {
        font-weight: normal;
    }
    ol, ul {
        padding-left: 1.7em;
        margin-top: 1em;
    }
    li > ol, li > ul {
        margin-top: 0;
    }
    blockquote {
        margin: 1em 0 1em 1.7em;
        padding-left: 1em;
        border-left: 2px solid #e6e6e6;
        color: #606060;
    }
    code {
        font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
        font-size: 85%;
        margin: 0;
        hyphens: manual;
    }
    pre {
        margin: 1em 0;
        overflow: auto;
    }
    pre code {
        padding: 0;
        overflow: visible;
        overflow-wrap: normal;
    }
    .sourceCode {
        background-color: transparent;
        overflow: visible;
    }
    hr {
        background-color: #1a1a1a;
        border: none;
        height: 1px;
        margin: 1em 0;
    }
    table {
        margin: 1em 0;
        border-collapse: collapse;
        width: 100%;
        overflow-x: auto;
        display: block;
        font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
        margin-bottom: 0.75em;
    }
    tbody {
        margin-top: 0.5em;
        border-top: 1px solid #1a1a1a;
        border-bottom: 1px solid #1a1a1a;
    }
    th {
        border-top: 1px solid #1a1a1a;
        padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
        padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
        margin-bottom: 4em;
        text-align: center;
    }
    #TOC li {
        list-style: none;
    }
    #TOC ul {
        padding-left: 1.3em;
    }
    #TOC > ul {
        padding-left: 0;
    }
    #TOC a:not(:hover) {
        text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
        font-size: inherit;
        width: 0.8em;
        margin: 0 0.8em 0.2em -1.6em;
        vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 1em; }
    @media screen {
        div.sourceCode { overflow: auto; }
    }
    @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
    { counter-reset: source-line 0; }
    pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
    }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
    { color: #cccccc; background-color: #303030; }
    @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffcfaf; } /* Alert */
    code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #dca3a3; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #f0dfaf; } /* ControlFlow */
    code span.ch { color: #dca3a3; } /* Char */
    code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code span.co { color: #7f9f7f; } /* Comment */
    code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code span.do { color: #7f9f7f; } /* Documentation */
    code span.dt { color: #dfdfbf; } /* DataType */
    code span.dv { color: #dcdccc; } /* DecVal */
    code span.er { color: #c3bf9f; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #c0bed1; } /* Float */
    code span.fu { color: #efef8f; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
    code span.kw { color: #f0dfaf; } /* Keyword */
    code span.op { color: #f0efd0; } /* Operator */
    code span.ot { color: #efef8f; } /* Other */
    code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code span.sc { color: #dca3a3; } /* SpecialChar */
    code span.ss { color: #cc9393; } /* SpecialString */
    code span.st { color: #cc9393; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #cc9393; } /* VerbatimString */
    code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
        </style>
        <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <header id="title-block-header">
            <h1 class="title">Cli Apps Database App. Required Loop</h1>
            <p class="date">08-08-2023 09:14</p>
        </header>
        <p>I felt a bit guilty because of my last posts’ laziness. I said that I
            would do just one post on loops, since they are similar.<br />
            Well, that is bullshit.<br />
            First, the object of this exercise is not to explain my projects to
            anyone, but for me to have some kind of memory, not only of code,
            there’s <em>Github</em> for that, but also of what I wanted to do, and
            the challenges I faced and how I overcame them. If in fact, I did.<br />
            So, I need to be thorough because, when I look at this project, five
            months from now, I won’t remember what possessed me to do it, how I came
            at the code solutions that I used and what was my thought process. I
            should, at the very least, explain the code, if the comments have not
            done that already, so I am able to reuse it with a degree of
            understanding.<br />
            And here I am. Ready to fulfill my historical duty to myself.</p>
        <p><strong><em>WITNESS ME!</em></strong></p>
        <p>I’m going to start by stealing the beginning of the <em>Cli Apps
                Database App. Location Loop</em>, which started life as <em>Cli Apps
                Database App. Function Loops</em> when I was feeling too cool to
            write.<br />
            It explains the <em>main</em> and <em>use_paths</em> modules, which is
            required reading for understanding how the loop fits in the app’s
            logic.<br />
            I’m doing this for you, future reader, as there’s no guarantee that
            you’ll read the <em>location loop</em> post first. You’re as much
            deserving of knowledge as the people who got the order right.</p>
        <p>I will show the function loops that query the <code>allinfo</code>
            data collection.<br />
            They are started if the user responds positively to any of the
            <em>req_decision</em> or <em>loc_decision</em> questions. The first
            fires the <code>required_loop</code>, (dedicated to retrieving
            information on dependencies), and the second, the
            <code>location_loop</code>, (aimed at finding and showing folder and
            files content). I’m going to post the entirety of the <em>main</em>
            module, so you can understand when and where this things come into
            play:</p>
        <h4>
            <u>main</u>
        </h4>
        <div class="sourceCode" id="cb1"><pre
                                class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="at">@click.command</span>()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">@click.argument</span>(<span class="st">&quot;keywords&quot;</span>, nargs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">@click.option</span>(<span class="st">&quot;-q&quot;</span>, <span class="st">&quot;--queries&quot;</span>, multiple<span class="op">=</span><span class="va">True</span>, is_flag<span class="op">=</span><span class="va">False</span>, flag_value<span class="op">=</span><span class="st">&quot;query&quot;</span>, default<span class="op">=</span>[])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">@click.option</span>(<span class="st">&quot;-i&quot;</span>, <span class="st">&quot;--ids&quot;</span>, multiple<span class="op">=</span><span class="va">True</span>, is_flag<span class="op">=</span><span class="va">False</span>, flag_value<span class="op">=</span><span class="st">&quot;id&quot;</span>, default<span class="op">=</span>[], <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">@click.option</span>(<span class="st">&quot;-n&quot;</span>, <span class="st">&quot;--names&quot;</span>, multiple<span class="op">=</span><span class="va">True</span>, is_flag<span class="op">=</span><span class="va">False</span>, flag_value<span class="op">=</span><span class="st">&quot;query&quot;</span>, default<span class="op">=</span>[])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># @snoop</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_query(keywords, queries, ids, names):</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Because we want to deal with complex queries, we&#39;ll get, in the same query, an</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    indefinite number of keywords, queries for natural language search, several</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    id&#39;s and names. This module will receive the information and send output to</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    different functions.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    da <span class="op">=</span> os.getenv(<span class="st">&quot;DA&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This the management code block. Each option/argument, has a allocated management</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># function, that&#39;s tasked of cleaning the input and making the db calls for each</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># query. Some will ask you if you want to see a given type of data, regardless if</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># you chose it in the command line or not. Others are more reserved.</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    keys <span class="op">=</span> kwd_mngmnt(keywords)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> queries <span class="op">!=</span> ():</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        queries_mngmnt(queries)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ids <span class="op">!=</span> ():</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        ids_mngmnt(ids)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    names_mngmnt(names)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is the initiation block. When you get a new query, that&#39;s what has to happen.</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    filelst <span class="op">=</span> os.listdir(da)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The names of pickled files that are created by the management modules.</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&quot;qlst.bin&quot;</span> <span class="kw">or</span> <span class="st">&quot;klst.bin&quot;</span> <span class="kw">or</span> <span class="st">&quot;ilst.bin&quot;</span> <span class="kw">or</span> <span class="st">&quot;nlst.bin&quot;</span> <span class="kw">in</span> filelst:</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Checks to see what files, from the above list, are present in the directory.</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        checkinfo()</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Joins the information in one document called &#39;allinfo&#39;.</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        aggregate_info()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Uses &#39;fzf&#39; to let the user check the results and choose what he wants to see from</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the output.</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        srch_allinfo()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shows a prettified version of the chosen information.</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        show_info(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">data_files&quot;</span>, <span class="st">&quot;PACKAGES IN DATA_FILES&quot;</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # Two questions: do you want to see file dependencies or their location?</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        re <span class="op">=</span> req_decision()</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        lc <span class="op">=</span> loc_decision()</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # Depending on the answer, you&#39;ll be sent in a loop of functions that&#39;ll expose you</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># # to the information you wanted.</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> re <span class="op">==</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            required_loop()</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> lc <span class="op">==</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            location_loop(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">data_files&quot;</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # This thing produces binary files like a motherfucker. Cleaning is in order.</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    delete_all_files()</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    get_query()</span></code></pre></div>
            <p>The loop structure is defined in a module called
                <strong><em>use_paths</em></strong>, because that’s what they really
                are: the directions that define of what’s used in
                <em>database_app</em>.<br />
                This is a heavily commented file, and I’ll just let it speak for
                itself.</p>
            <h4>
                <u>use_paths</u>
            </h4>
            <div class="sourceCode" id="cb2"><pre
                                    class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">Module that define the functions that&#39;ll be served</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">depending on user&#39;s choices. If the user chooses</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;locations&#39; or &#39;dependencies&#39;, it&#39;ll have different</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">information presented to him. We define what</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">information it is and in what way is shown.</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">At the moment I put a limit of 10 in the capacity to</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">ask again the same type of question. But when I feel</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">more sure about the workings of this solution I would</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">like it to be limitless.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> snoop</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> snoop <span class="im">import</span> pp</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> location <span class="im">import</span> dislocation, package_location, show_dirpath</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> methods <span class="im">import</span> loc_decision, pip_info, req_decision, yay_info</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> required_by <span class="im">import</span> choice_processing, collect_deps_info, get_lst, show</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> type_watch(source, value):</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&quot;type(</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">)&quot;</span>, <span class="bu">type</span>(value)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>snoop.install(watch_extras<span class="op">=</span>[type_watch])</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>load_dotenv()</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># @snoop</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> required_loop():</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">    This is the structure of the loop to run</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">    if user only wants to see dependencies.</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co">    The basic concept is for the user to be</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co">    able to repeat its dependencies searches</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co">    as much as he wants, going as deep as he</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co">    likes. You can leave the loop if you don&#39;t</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co">    answer the questions or, by the program&#39;s</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">    will, if there&#39;s a problem with the code.</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    da <span class="op">=</span> os.getenv(<span class="st">&quot;DA&quot;</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The first call to dependencies is done when</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># there&#39;s only package files in &#39;data_files&#39;.</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># After that is always in &#39;required_files&#39;. We</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># needed to have a first look at the files still</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in &#39;data_files&#39;. That&#39;s the reason why there&#39;s</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a get_lst() call before the loop.</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> get_lst(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">data_files&quot;</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> out <span class="op">==</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>            show()</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>            choice_processing(<span class="st">&quot;choice_deps.bin&quot;</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>            srch <span class="op">=</span> collect_deps_info()</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>            yay_info(srch)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>            pip_info(srch)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># So as not to break the loop, we took out the SystemExit</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># we had for when there was an error, and replaced it with</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># &#39;return&#39; statements. If there&#39;s an error get_lst()</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># returns &#39;n&#39;, if everything went correctly, it outputs &#39;y&#39;.</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># This way the flow is controlled when designing the loop,</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># making it easier to change when needed.</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            gl <span class="op">=</span> get_lst(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">required_files&quot;</span>)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> gl <span class="op">!=</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># After the loop has ran, we ask the user if he wants to see</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the packages locations. In the &#39;location&#39; loop it&#39;s the</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># other way around.</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    loc <span class="op">=</span> loc_decision()</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If it starts after the &#39;required_loop&#39; having ran, we know that</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the last information is in &#39;required_files&#39;. So we set the</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &#39;location_loop&#39; location to it.</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> loc <span class="op">==</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        location_loop(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">required_files&quot;</span>)</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    required_loop()</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="at">@snoop</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> location_loop(folder):</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="co">    Loop for the &#39;location&#39; module. Here,</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a><span class="co">    because we don&#39;t have to create data</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co">    from one location to another, we can</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co">    leave it for the callers of the loop</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="co">    the decision on what folder to use.</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>        inner <span class="op">=</span> package_location(folder)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> inner <span class="op">!=</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        dislocation()</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>        show_dirpath()</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> req_decision()</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> req <span class="op">==</span> <span class="st">&quot;y&quot;</span>:</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        required_loop()</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    location_loop()</span></code></pre></div>
                <h3>
                    <u>REQUIRED LOOP</u>
                </h3>
                <p>Most of the functions that the <code>required loop</code> uses are in
                    the <em>required_by</em> module.<br />
                    As you can tell, I spend far too little time thinking on what to name
                    things, and that, sometimes, comes back and bites me in the ass.<br />
                    From the list of packages initially chosen, we’ll discover what are
                    their dependencies.<br />
                    We start with:</p>
                <h4>
                    <u>get_lst</u>
                </h4>
                <p>Iterates through the files in <em>data_files</em> or
                    <em>required_files</em>, and looks for information on dependencies, if
                    it finds any it adds the package name and the dependency name in a tuple
                    and stores it in a list.<br />
                    If you’re keen observer, you’ll notice that <em>get_lst</em> returns
                    <strong><em>n</em></strong>, in case of error and
                    <strong><em>y</em></strong>, if everything goes according to plan. These
                    return codes are then read by <em>use_paths</em>, that will stop the
                    loop if anything’s wrong.</p>
                <div class="sourceCode" id="cb3"><pre
                                        class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_lst(folder):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Iterates through the files in &#39;folder&#39;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    and looks for information on dependencies,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    if it finds that package has dependecies,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">    it adds the package name and the dependecy</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    name in a tuple and stores it in a list.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    cwd <span class="op">=</span> <span class="st">&quot;/home/mic/python/cli_apps/cli_apps/database_app&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    console <span class="op">=</span> Console()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I&#39;m putting this here in case if get_lst() doesn&#39;t</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find dependecies, there&#39;ll be no &#39;spltlst.bin&#39; for</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show(). It searches for the file at the  beginning,</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># looking for a undeleted &#39;spltlst.bin&#39; from a past</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># run, if it finds it,  it delestes it.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># In case this run fails and show() uses the old file.</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&quot;spltlst.bin&quot;</span> <span class="kw">in</span> os.listdir(cwd):</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        os.remove(<span class="ss">f&quot;</span><span class="sc">{</span>cwd<span class="sc">}</span><span class="ss">/spltlst.bin&quot;</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    fils <span class="op">=</span> os.listdir(folder)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    lst <span class="op">=</span> []</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> fils:</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">&quot;</span>, <span class="st">&quot;r&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>            fil <span class="op">=</span> f.readlines()</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> f <span class="kw">in</span> fil:</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Format found in files created by &#39;yay -Qi&#39;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> f.startswith(<span class="st">&quot;Required By     : &quot;</span>):</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> f <span class="op">!=</span> f.startswith(<span class="st">&quot;Required By     : None</span><span class="ch">\n</span><span class="st">&quot;</span>):</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># The title and spaces occupy 18 px, the 20 px</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># its that value and a small margin of confort.</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">len</span>(f) <span class="op">&gt;</span> <span class="dv">20</span>:</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Deletes the title from the line. We now have</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># only the dependecies names.</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                            deps <span class="op">=</span> f[<span class="dv">18</span>:]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                            lst.append((<span class="bu">file</span>, deps))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Format found in files created by &#39;pip show&#39;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> f.startswith(<span class="st">&quot;Required-by: &quot;</span>):</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">len</span>(f) <span class="op">&gt;</span> <span class="dv">15</span>:</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                        deps <span class="op">=</span> f[<span class="dv">13</span>:]</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                        lst.append((<span class="bu">file</span>, deps))</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The info comes with linebreaks, we strip them and eliminate</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># entries with only &quot;None&quot;.</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    cleanlst <span class="op">=</span> [(a, i.strip()) <span class="cf">for</span> a, i <span class="kw">in</span> lst <span class="cf">if</span> i <span class="op">!=</span> <span class="st">&quot;None</span><span class="ch">\n</span><span class="st">&quot;</span>]</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If nothing&#39;s there, it&#39;ll be mostly, for not having found dependecies.</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We delete the files of &#39;data_files&#39; and return &#39;y&#39;. This value wiçç be</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># picked up in the &#39;use_cases&#39; module, and they&#39;ll break the loop.</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cleanlst <span class="op">==</span> []:</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        console.<span class="bu">print</span>(<span class="st">&quot;T[bold #E48586]         required_by.get_lst(): The chosen packages are required by none.&quot;</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If we find dependencies, we look for empty spaces in the strings we</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># collected. If there&#39;s empty spaces it&#39;s because its a list of dependecies.</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We split the string so as to create a list.</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        spltlst <span class="op">=</span> []</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> cleanlst:</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&quot;, &quot;</span> <span class="kw">in</span> tup[<span class="dv">1</span>]:</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                nw <span class="op">=</span> (tup[<span class="dv">0</span>], tup[<span class="dv">1</span>].split(<span class="st">&quot;, &quot;</span>))</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> n <span class="kw">in</span> nw[<span class="dv">1</span>]:</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> n <span class="op">==</span> <span class="st">&quot;&quot;</span>:</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                        nw[<span class="dv">1</span>].remove(n)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                spltlst.append(nw)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>                nw <span class="op">=</span> (tup[<span class="dv">0</span>], tup[<span class="dv">1</span>].split(<span class="st">&quot; &quot;</span>))</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> n <span class="kw">in</span> nw[<span class="dv">1</span>]:</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> n <span class="op">==</span> <span class="st">&quot;&quot;</span>:</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                        nw[<span class="dv">1</span>].remove(n)</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>                spltlst.append(nw)</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>cwd<span class="sc">}</span><span class="ss">/spltlst.bin&quot;</span>, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>            pickle.dump(spltlst, f)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;y&quot;</span></span></code></pre></div>
                    <h4>
                        <u>show</u>
                    </h4>
                    <p>Visualizes the results.</p>
                    <div class="sourceCode" id="cb4"><pre
                                            class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show():</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Visualizes the results.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    We use mostly *Rich* to views results, except</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    in the *input* method. Although &#39;rich&#39; has</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    their own implementation of &#39;input&#39;, it shows</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    the prompt, one line below the text and pressed</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    to the border of the screen.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    da <span class="op">=</span> os.getenv(<span class="st">&quot;DA&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&quot;spltlst.bin&quot;</span> <span class="kw">in</span> os.listdir(da):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">spltlst.bin&quot;</span>, <span class="st">&quot;rb&quot;</span>) <span class="im">as</span> t:</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            deps <span class="op">=</span> pickle.load(t)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> deps <span class="op">!=</span> []:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># &#39;numbered_deps&#39; will collect the id&#39;d version of &#39;deps&#39; this module will create.</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            numbered_deps <span class="op">=</span> []</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            console <span class="op">=</span> Console()</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            console.<span class="bu">print</span>(</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                Padding(<span class="st">&quot;[bold #E9FFC2]DEPENDENCIES[/]&quot;</span>, (<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>)),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                justify<span class="op">=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(deps)):</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> deps[i][<span class="dv">0</span>]:</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                    console.<span class="bu">print</span>(</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                        Padding(<span class="ss">f&quot;[bold #AAC8A7]</span><span class="ch">\n</span><span class="sc">{</span>deps[i][<span class="dv">0</span>][:<span class="op">-</span><span class="dv">4</span>]<span class="sc">}</span><span class="ss">[/]&quot;</span>, (<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">type</span>(deps[i][<span class="dv">1</span>]) <span class="op">==</span> <span class="bu">list</span>:</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> idx, t <span class="kw">in</span> <span class="bu">enumerate</span>(deps[i][<span class="dv">1</span>]):</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># collects a dependency id made of the index of the chosen package,</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># plus the index of the dependecy. This permits us to know what is</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># the package and dependecy name.</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                        numdp <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{</span>i<span class="sc">}{</span>idx<span class="sc">}</span><span class="ss">&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>deps[i][<span class="dv">0</span>][:<span class="op">-</span><span class="dv">4</span>]<span class="sc">}</span><span class="ss">&quot;</span>]</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                        numbered_deps.append(numdp)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                        console.<span class="bu">print</span>(</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                            Padding(</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                                <span class="ss">f&quot;[bold #FFD6A5]\[</span><span class="sc">{</span>i<span class="sc">}{</span>idx<span class="sc">}</span><span class="ss">] - [/][bold #E9FFC2]</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">[/]&quot;</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                                (<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">14</span>),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>                    console.<span class="bu">print</span>(</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                        Padding(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                            <span class="ss">f&quot;[bold #E9FFC2]\[</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">0] - </span><span class="sc">{</span>deps[i][<span class="dv">1</span>]<span class="sc">}</span><span class="ss">[/]&quot;</span>, (<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">14</span>)</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                    numdp <span class="op">=</span> [<span class="ss">f&quot;</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">0&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>deps[i][<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>, <span class="ss">f&quot;</span><span class="sc">{</span>deps[i][<span class="dv">0</span>][:<span class="op">-</span><span class="dv">4</span>]<span class="sc">}</span><span class="ss">&quot;</span>]</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>                    numbered_deps.append(numdp)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>            choice_deps <span class="op">=</span> <span class="bu">input</span>(</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>                style(</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;          Choose the dependecies you want to see. Press Enter to quit. &quot;</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                    bold<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>                    fg<span class="op">=</span>(<span class="dv">160</span>, <span class="dv">196</span>, <span class="dv">157</span>),</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>            console.<span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> choice_deps <span class="op">!=</span> <span class="st">&quot;&quot;</span>:</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">choice_deps.bin&quot;</span>, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> g:</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                    pickle.dump(choice_deps, g)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">numdeps.bin&quot;</span>, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                    pickle.dump(numbered_deps, f)</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>            console.<span class="bu">print</span>(</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;[bold #FFD6A5]         rrequired_by.show():[/bold #FFD6A5] [bold #E48586]&#39;spltlst.bin&#39; is an empty list.&quot;</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
                        <p>This is what you’ll see:</p>
                        <figure>
                            <img src="/home/mic/python/cli_diary/cli_diary/imgs/deps.png"
                                 alt="Required" />
                            <figcaption aria-hidden="true">Required</figcaption>
                        </figure>
                        <h4>
                            <u>choice_processing</u>
                        </h4>
                        <p>This is, by far, the most useful function of the bunch. So much so
                            ,that I’m going to put it somewhere central, where all the other
                            projects can get to it.<br />
                            What it does is simple, but has some steps, and if you can outsource it,
                            you will.<br />
                            It turns a string with several elements, in a list of strings.<br />
                            They can be separated by spaces, commas and spaces, or commas only, it
                            <em>listifies</em> them all.<br />
                            At the moment, it reads from a binary and outputs another. But I think
                            I’m going to change that to returning the list. There’s no time delay or
                            memory usage that justifies returning a binary.</p>
                        <div class="sourceCode" id="cb5"><pre
                                                class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> choice_processing(binary):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">    As &quot;choice_deps&quot; comes in as a string, that may contain one</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">    or more choices, and because the user can write its input</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    in several ways, will try to predict some of them, and handle</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">    the input so to have a list of dependecies in the end.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    da <span class="op">=</span> os.getenv(<span class="st">&quot;DA&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="ss">f&quot;</span><span class="sc">{</span>binary<span class="sc">}</span><span class="ss">&quot;</span> <span class="kw">in</span> os.listdir(da):</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}{</span>binary<span class="sc">}</span><span class="ss">&quot;</span>, <span class="st">&quot;rb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            choices <span class="op">=</span> pickle.load(f)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&quot; &quot;</span> <span class="kw">in</span> choices:</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            choice <span class="op">=</span> choices.split(<span class="st">&quot; &quot;</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&quot;, &quot;</span> <span class="kw">in</span> choices:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            choice <span class="op">=</span> choices.split(<span class="st">&quot;, &quot;</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&quot; &quot;</span> <span class="kw">not</span> <span class="kw">in</span> choices:</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            choice <span class="op">=</span> choices</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&quot;,&quot;</span> <span class="kw">in</span> choices:</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            choice <span class="op">=</span> choices.split(<span class="st">&quot;,&quot;</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">choice.bin&quot;</span>, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> g:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            pickle.dump(choice, g)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        console <span class="op">=</span> Console()</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        console.<span class="bu">print</span>(</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;[bold #FFD6A5]         required_by.choice_processing():[/bold #FFD6A5] [bold #E48586]Couldn&#39;t find the </span><span class="sc">{</span>binary<span class="sc">}</span><span class="ss"> file.&quot;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">SystemExit</span></span></code></pre></div>
                            <h4>
                                <u>collect_deps_info</u>
                            </h4>
                            <p>Collects information on the chosen dependencies.</p>
                            <div class="sourceCode" id="cb6"><pre
                                                    class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># @snoop</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> collect_deps_info():</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Collects information on the chosen dependencies.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    da <span class="op">=</span> os.getenv(<span class="st">&quot;DA&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">numdeps.bin&quot;</span>, <span class="st">&quot;rb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        numdeps <span class="op">=</span> pickle.load(f)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f&quot;</span><span class="sc">{</span>da<span class="sc">}</span><span class="ss">choice.bin&quot;</span>, <span class="st">&quot;rb&quot;</span>) <span class="im">as</span> g:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        choice <span class="op">=</span> pickle.load(g)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    srch <span class="op">=</span> [</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        (numdeps[i][<span class="dv">1</span>], numdeps[i][<span class="dv">2</span>])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(numdeps))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> numdeps[i][<span class="dv">0</span>] <span class="kw">in</span> choice</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will add a code to the &#39;srch&#39; list that&#39;ll allow &#39;yay_info&#39;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and &#39;pip_info&#39; to know what is the internal structure of &#39;srch&#39;,</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># that is very different from that that is created by &#39;srch_allinfo&#39;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># when called by &#39;main&#39;.</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    srch.append(<span class="st">&quot;req&quot;</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> srch</span></code></pre></div>
                                <p>And here stops the iteration of the loop. There’s still some things I
                                    need to change.<br />
                                    Now, after choosing to follow a package dependencies, if its choice is
                                    required by nothing, the loop stops.<br />
                                    I would like to get it back to the beginning, for the user to choose
                                    another package, if he wants it.<br />
                                    It’s in my <em>TODO’s</em> list.</p>
    </body>
</html>
